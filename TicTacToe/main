require_relative 'Board'
require_relative 'Competitor'
require_relative 'Move'

def play_game?
	puts 'Would you like to play Tic Tac Toe? Type Y to play.'
	if gets.chomp.upcase == 'Y' 
		true
	else 
		puts 'Goodbye!'
		exit
	end
end

def get_number_players
	puts 'How many players? Choose 1 or 2'
	if gets.to_i == 1
		@player1 = Competitor.new('X', 'Human')
		@player2 = Competitor.new('O', 'Computer')
		puts "#{@player1.name} is #{@player1.letter}, #{@player2.name} is #{@player2.letter}"
	else
		@player1 = Competitor.new('X', 'Player 1')
		@player2 = Competitor.new('O', 'Player 2')
		puts 'Player 1 is X, Player 2 is O'
	end
end

def main
	play_game?
	@initial = Board.new
	@nextmove = Move.new
	get_number_players
	players = [@player1, @player2].cycle
	loop do
		current_player = players.next
	  	play_turn(current_player.name, current_player.letter)
		main if game_end?(current_player.name)
	end
end

def play_turn(name, letter)
	@initial.print_board
	puts "#{name} to go next"
	potential_position = @nextmove.next_move(name)
	until @initial.valid_move?(potential_position) do
	  	 potential_position = @nextmove.next_move(name)
	end
	@initial.update(potential_position, letter)
end

def game_end?(current_player)
	if @initial.win?
	  	@initial.print_board
	  	puts "#{current_player} wins!"
	  	true
	elsif @initial.draw?
	  	@initial.print_board
	  	puts "draw"
	  	true
  	end
end

main
